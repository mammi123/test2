local p,w=print,warn;local HttpService=game:GetService("HttpService");local Players=game:GetService("Players");local requestFunc=request or http_request or(syn and syn.request)or(fluxus and fluxus.request);if type(requestFunc)~="function"then w("!NO REQ")return end;local ngrok_url="https://adfa-2a02-a317-2293-6d80-d517-cf9b-e83f-8f68.ngrok-free.app";p("A1:GET");local get_success,response=pcall(function()return requestFunc({Url=ngrok_url.."/api/get_data",Method="GET"})end);if not get_success or not response or response.StatusCode~=200 then w("!A1:FAIL:"..tostring(response and response.StatusCode or response or "?"));p("?ngrok/flask up?")return end;local decode_ok,serverData=pcall(function()return HttpService:JSONDecode(response.Body)end);if not decode_ok or not serverData or not serverData.player_info then w("!A1:JSON FAIL")return end;local targetPlayerInfo=serverData.player_info;p("A1 OK: TGT="..targetPlayerInfo.username);p("A2:SCAN");local player_list_for_post={};local isTargetPlayerInServer=false;for _,player in ipairs(Players:GetPlayers())do table.insert(player_list_for_post,{username=player.Name,user_id=player.UserId});if player.UserId==targetPlayerInfo.user_id then isTargetPlayerInServer=true;p(" > TGT FOUND: "..player.Name)end end;if not isTargetPlayerInServer then p(" > TGT NOT FOUND")end;p("A2 OK");p("A3:POST");local data_to_send={players=player_list_for_post,target_check={found=isTargetPlayerInServer,target_username=targetPlayerInfo.username,target_id=targetPlayerInfo.user_id}};local json_encode_success,json_body=pcall(function()return HttpService:JSONEncode(data_to_send)end);if not json_encode_success then w("!A3:JSON FAIL:"..tostring(json_body))return end;local post_success,post_response=pcall(function()return requestFunc({Url=ngrok_url.."/api/player_list",Method="POST",Headers={["Content-Type"]="application/json"},Body=json_body})end);if post_success and post_response and post_response.StatusCode==200 then local final_decode_ok,final_data=pcall(function()return HttpService:JSONDecode(post_response.Body)end);if final_decode_ok and final_data then p("A3 OK:"..final_data.message)else w("!A3:RESP FAIL")end else w("!A3:POST FAIL:"..tostring(post_response and post_response.StatusCode or post_response or "?"))end;p("DONE")
